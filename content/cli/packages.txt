> indusagi can help you create indusagi packages. Ask it to bundle your extensions, skills, prompt templates, or themes.

# Indusagi Packages

Indusagi packages bundle extensions, skills, prompt templates, and themes so you can share them through npm or git. A package can declare resources in `package.json` under the `indusagi` key, or use conventional directories.

## Table of Contents

- [Install and Manage](#install-and-manage)
- [Package Sources](#package-sources)
- [Creating a Indusagi Package](#creating-a-indusagi-package)
- [Package Structure](#package-structure)
- [Package Filtering](#package-filtering)
- [Enable and Disable Resources](#enable-and-disable-resources)
- [Scope and Deduplication](#scope-and-deduplication)

## Install and Manage

> **Security:** Indusagi packages run with full system access. Extensions execute arbitrary code, and skills can instruct the model to perform any action including running executables. Review source code before installing third-party packages.

```bash
indusagi install npm:@foo/bar@1.0.0
indusagi install git:github.com/user/repo@v1
indusagi install https://github.com/user/repo  # raw URLs work too

indusagi remove npm:@foo/bar
indusagi list    # show installed packages from settings
indusagi update  # update all non-pinned packages
```

By default, `install` and `remove` write to global settings (`~/.indusagi/agent/settings.json`). Use `-l` to write to project settings (`.indusagi/settings.json`) instead. Project settings can be shared with your team, and indusagi installs any missing packages automatically on startup.

To try a package without installing it, use `--extension` or `-e`. This installs to a temporary directory for the current run only:

```bash
indusagi -e npm:@foo/bar
indusagi -e git:github.com/user/repo
```

## Package Sources

Indusagi accepts three source types in settings and `indusagi install`.

### npm

```
npm:@scope/pkg@1.2.3
npm:pkg
```

- Versioned specs are pinned and skipped by `indusagi update`.
- Global installs use `npm install -g`.
- Project installs go under `.indusagi/npm/`.

### git

```
git:github.com/user/repo@v1
https://github.com/user/repo@v1
```

- Raw `https://` URLs work without the `git:` prefix.
- Refs pin the package and skip `indusagi update`.
- Cloned to `~/.indusagi/agent/git/<host>/<path>` (global) or `.indusagi/git/<host>/<path>` (project).
- Runs `npm install` after clone or pull if `package.json` exists.

### Local Paths

```
/absolute/path/to/package
./relative/path/to/package
```

Local paths work in settings but not with `indusagi install`. If the path is a file, it loads as a single extension. If it is a directory, indusagi loads resources using package rules.

## Creating a Indusagi Package

Add a `indusagi` manifest to `package.json` or use conventional directories. Include the `indusagi-package` keyword for discoverability.

```json
{
  "name": "my-package",
  "keywords": ["indusagi-package"],
  "indusagi": {
    "extensions": ["./extensions"],
    "skills": ["./skills"],
    "prompts": ["./prompts"],
    "themes": ["./themes"]
  }
}
```

Paths are relative to the package root. Arrays support glob patterns and `!exclusions`.

## Package Structure

### Convention Directories

If no `indusagi` manifest is present, indusagi auto-discovers resources from these directories:

- `extensions/` loads `.ts` and `.js` files
- `skills/` recursively finds `SKILL.md` folders and loads top-level `.md` files as skills
- `prompts/` loads `.md` files
- `themes/` loads `.json` files

### Bundling Other Indusagi Packages

Bundle other indusagi packages by adding them as dependencies and listing them in `bundledDependencies`. Reference their resources via `node_modules/` paths.

```json
{
  "dependencies": {
    "shitty-extensions": "^1.0.1"
  },
  "bundledDependencies": ["shitty-extensions"],
  "indusagi": {
    "extensions": ["extensions", "node_modules/shitty-extensions/extensions"],
    "skills": ["skills", "node_modules/shitty-extensions/skills"]
  }
}
```

`bundledDependencies` embeds the package in the published tarball, keeping paths stable. See `indusagi-package-test` for a working example.

## Package Filtering

Filter what a package loads using the object form in settings:

```json
{
  "packages": [
    "npm:simple-pkg",
    {
      "source": "npm:my-package",
      "extensions": ["extensions/*.ts", "!extensions/legacy.ts"],
      "skills": [],
      "prompts": ["prompts/review.md"],
      "themes": ["+themes/legacy.json"]
    }
  ]
}
```

`+path` and `-path` are exact paths relative to the package root.

- Omit a key to load all of that type.
- Use `[]` to load none of that type.
- `!pattern` excludes matches.
- `+path` force-includes an exact path.
- `-path` force-excludes an exact path.
- Filters layer on top of the manifest. They narrow down what is already allowed.

## Enable and Disable Resources

Use `indusagi config` to enable or disable extensions, skills, prompt templates, and themes from installed packages and local directories. Works for both global (`~/.indusagi/agent`) and project (`.indusagi/`) scopes.

## Scope and Deduplication

Packages can appear in both global and project settings. If the same package appears in both, the project entry wins. Identity is determined by:

- npm: package name
- git: repository URL without ref
- local: resolved absolute path
